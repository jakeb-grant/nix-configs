{ config, pkgs, ... }:

let
  # Import personal configuration (gitignored, created by setup.sh)
  secrets = if builtins.pathExists ./secrets.nix
    then import ./secrets.nix
    else {
      personalInfo = {
        userName = "user";
        fullName = "Main User";
        email = "your.email@example.com";
        gitName = "";
        timezone = "America/Denver";
      };
    };
in
{
  imports = [
    # Hardware configuration (generated by nixos-generate-config)
    ./hardware-configuration.nix

    # Shared system modules
    ../../modules/system/user.nix
    ../../modules/system/core.nix
    ../../modules/system/desktop.nix

    # Desktop-specific hardware
    ../../modules/system/hardware/nvidia.nix

    # Home manager configuration
    ../../modules/home
  ];

  # Hostname
  networking.hostName = "desktop";

  # Timezone from secrets
  time.timeZone = secrets.personalInfo.timezone;

  # Main user configuration from secrets
  main-user = {
    enable = true;
    userName = secrets.personalInfo.userName;
    description = secrets.personalInfo.fullName;
    email = secrets.personalInfo.email;
    gitName = secrets.personalInfo.gitName;
  };

  # Desktop-specific configuration can go here
}
